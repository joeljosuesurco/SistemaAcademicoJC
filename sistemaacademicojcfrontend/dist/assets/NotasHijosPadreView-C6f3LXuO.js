import{l as b,p as J,H as B,f as D,O as Q,M as F,w as Y,Q as Z,o as l,a as e,c as i,x as y,e as v,E as o,J as H,Z as q,F as $,L as P,n as O,d as k,D as w,Y as G}from"./index-DqMIVmN9.js";const K={class:"p-6"},W={key:0,class:"bg-white border rounded shadow p-6"},X={key:0,class:"mt-4 mb-4"},ee={key:1,class:"overflow-x-auto"},te={class:"min-w-full text-center border border-gray-200 bg-white rounded-xl shadow-sm"},se={class:"border px-4 py-2 text-left font-medium"},oe={class:"border px-4 py-2"},ae={class:"border px-4 py-2"},re={class:"border px-4 py-2"},le={class:"border px-4 py-2"},ne={class:"border px-4 py-2"},de={class:"border px-4 py-2"},ie={class:"border px-4 py-2 font-bold text-blue-800"},ue={key:2,class:"overflow-x-auto mt-6"},ce={class:"min-w-full text-center border border-gray-200 bg-white rounded-xl shadow-sm"},pe={class:"border px-4 py-2 text-left font-medium"},be={class:"border px-4 py-2"},me={class:"border px-4 py-2"},_e={class:"border px-4 py-2"},ve={class:"border px-4 py-2 font-bold text-blue-800"},xe={class:"mt-6 flex gap-2"},fe={key:1},he={class:"mb-4"},ye={key:0,class:"text-gray-500"},we={key:1,class:"text-red-600"},ge={key:2,class:"w-full text-left bg-white rounded shadow"},Ce={class:"p-2"},ke={class:"p-2"},Me={class:"p-2"},Le={class:"p-2"},$e={key:3,class:"mt-4 flex justify-center items-center gap-2"},E=10,Ne={__name:"NotasHijosPadreView",setup(Pe){const h=b([]),m=b(null),N=b([]),S=b([]),x=b(!1),g=b("trimestre 1"),p=b(""),f=b(1),T=b(!0),M=b(null);J(async()=>{try{const r=await B.get("/padre-auth/hijos");h.value=r.data.data||[]}catch(r){M.value="No se pudo cargar la lista de hijos",console.error(r)}finally{T.value=!1}});const z=D(()=>{const r=p.value?h.value.filter(n=>{var u,d,t;return n.nombre_completo.toLowerCase().includes(p.value.toLowerCase())||`${(u=n.curso)==null?void 0:u.grado_curso} ${(d=n.curso)==null?void 0:d.paralelo_curso}`.toLowerCase().includes(p.value.toLowerCase())||((t=n.curso)==null?void 0:t.nivel.toLowerCase().includes(p.value.toLowerCase()))}):h.value,s=(f.value-1)*E;return r.slice(s,s+E)}),L=D(()=>{const r=p.value?h.value.filter(s=>{var n,u,d;return s.nombre_completo.toLowerCase().includes(p.value.toLowerCase())||`${(n=s.curso)==null?void 0:n.grado_curso} ${(u=s.curso)==null?void 0:u.paralelo_curso}`.toLowerCase().includes(p.value.toLowerCase())||((d=s.curso)==null?void 0:d.nivel.toLowerCase().includes(p.value.toLowerCase()))}).length:h.value.length;return Math.ceil(r/E)});function I(r){m.value=r,x.value=!1,j()}function R(){m.value=null,x.value=!1}function U(){x.value=!0}function V(r){const s=Math.round((r.ser_docente||0)*.05),n=Math.round((r.saber_docente||0)*.45),u=Math.round((r.hacer_docente||0)*.4),d=Math.round((r.decidir_docente||0)*.05),t=Math.round((r.ser_autoeval||0)*.05),a=Math.round((r.decidir_autoeval||0)*.05);return Math.min(s+n+u+d+t+a,100)}async function j(){if(!m.value)return;const[r,s]=g.value.split(" ");try{const u=(await B.get(`/padre-auth/notas/${m.value.id_estudiante}`,{params:{periodo:r,numero_periodo:s}})).data.data.notas;N.value=u.map(t=>{const a=Object.fromEntries(t.dimensiones.map(c=>[c.nombre_dimension,c.valor_obtenido])),_=V(a);return{nombre:`${t.materia.area_materia} (${t.materia.sigla_materia})`,ser_raw:a.ser_docente||0,saber_raw:a.saber_docente||0,hacer_raw:a.hacer_docente||0,decidir_raw:a.decidir_docente||0,ser_auto_raw:a.ser_autoeval||0,decidir_auto_raw:a.decidir_autoeval||0,promedio:_}});const d=new Map;u.forEach(t=>{const a=Object.fromEntries(t.dimensiones.map(A=>[A.nombre_dimension,A.valor_obtenido])),_=V(a),c=t.materia.id_materia;d.has(c)||d.set(c,{nombre:`${t.materia.area_materia} (${t.materia.sigla_materia})`,t1:0,t2:0,t3:0});const C=d.get(c);C[`t${t.numero_periodo}`]=_}),S.value=Array.from(d.values()).map(t=>{const _=[t.t1,t.t2,t.t3].reduce((c,C)=>c+C,0);return{...t,promedio:Math.min(Math.round(_/3),100)}})}catch(n){console.error("Error al cargar notas:",n)}}return Q(g,j),(r,s)=>(l(),F(Z,null,{default:Y(()=>{var n,u,d;return[e("div",K,[s[12]||(s[12]=e("h2",{class:"text-xl font-bold mb-4"},"Notas de mis hijos",-1)),m.value?(l(),i("div",W,[e("p",null,[s[4]||(s[4]=e("strong",null,"Estudiante:",-1)),v(" "+o(m.value.nombre_completo),1)]),e("p",null,[s[5]||(s[5]=e("strong",null,"Curso:",-1)),v(" "+o((n=m.value.curso)==null?void 0:n.grado_curso)+" "+o((u=m.value.curso)==null?void 0:u.paralelo_curso)+" - "+o((d=m.value.curso)==null?void 0:d.nivel),1)]),x.value?y("",!0):(l(),i("div",X,[s[7]||(s[7]=e("label",{class:"block text-sm font-medium mb-1"},"Periodo",-1)),H(e("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>g.value=t),class:"px-3 py-2 border rounded shadow-sm w-52"},s[6]||(s[6]=[e("option",{value:"trimestre 1"},"Trimestre 1",-1),e("option",{value:"trimestre 2"},"Trimestre 2",-1),e("option",{value:"trimestre 3"},"Trimestre 3",-1)]),512),[[q,g.value]])])),x.value?y("",!0):(l(),i("div",ee,[e("table",te,[s[8]||(s[8]=e("thead",null,[e("tr",null,[e("th",{rowspan:"3",class:"border px-4 py-2 font-semibold text-blue-800 bg-blue-50"}," MATERIAS "),e("th",{colspan:"4",class:"border px-4 py-2 font-semibold bg-blue-100 text-blue-700"}," Evaluación Maestro(a) "),e("th",{colspan:"2",class:"border px-4 py-2 font-semibold bg-purple-100 text-purple-700"}," Autoevaluación "),e("th",{rowspan:"3",class:"border px-4 py-2 font-semibold text-blue-800 bg-blue-50"}," Promedio ")]),e("tr",null,[e("th",{colspan:"4",class:"border px-4 py-2 font-medium bg-blue-200 text-blue-600"}," Dimensiones "),e("th",{colspan:"2",class:"border px-4 py-2 font-medium bg-purple-200 text-purple-700"}," Dimensiones ")]),e("tr",null,[e("th",{class:"border px-4 py-2 font-medium text-blue-700"},[v(" Ser "),e("span",{class:"text-xs text-blue-600 font-bold"},"(5 Pts.)")]),e("th",{class:"border px-4 py-2 font-medium text-blue-700"},[v(" Saber "),e("span",{class:"text-xs text-blue-600 font-bold"},"(45 Pts.)")]),e("th",{class:"border px-4 py-2 font-medium text-blue-700"},[v(" Hacer "),e("span",{class:"text-xs text-blue-600 font-bold"},"(40 Pts.)")]),e("th",{class:"border px-4 py-2 font-medium text-blue-700"},[v(" Decidir "),e("span",{class:"text-xs text-blue-600 font-bold"},"(5 Pts.)")]),e("th",{class:"border px-4 py-2 font-medium text-purple-700"},[v(" Ser "),e("span",{class:"text-xs text-purple-600 font-bold"},"(5 Pts.)")]),e("th",{class:"border px-4 py-2 font-medium text-purple-700"},[v(" Decidir "),e("span",{class:"text-xs text-purple-600 font-bold"},"(5 Pts.)")])])],-1)),e("tbody",null,[(l(!0),i($,null,P(N.value,(t,a)=>(l(),i("tr",{key:a,class:O(a%2===0?"bg-white":"bg-gray-50")},[e("td",se,o(t.nombre),1),e("td",oe,o(t.ser_raw),1),e("td",ae,o(t.saber_raw),1),e("td",re,o(t.hacer_raw),1),e("td",le,o(t.decidir_raw),1),e("td",ne,o(t.ser_auto_raw),1),e("td",de,o(t.decidir_auto_raw),1),e("td",ie,o(t.promedio),1)],2))),128))])])])),x.value?(l(),i("div",ue,[s[10]||(s[10]=e("h3",{class:"text-xl font-semibold mb-4 text-blue-800"},"Boleta de Calificaciones",-1)),e("table",ce,[s[9]||(s[9]=e("thead",null,[e("tr",null,[e("th",{class:"border px-4 py-2 font-semibold text-blue-800 bg-blue-50"},"MATERIAS"),e("th",{class:"border px-4 py-2"},"1er Trim"),e("th",{class:"border px-4 py-2"},"2do Trim"),e("th",{class:"border px-4 py-2"},"3er Trim"),e("th",{class:"border px-4 py-2"},"Promedio Final")])],-1)),e("tbody",null,[(l(!0),i($,null,P(S.value,(t,a)=>(l(),i("tr",{key:a,class:O(a%2===0?"bg-white":"bg-gray-50")},[e("td",pe,o(t.nombre),1),e("td",be,o(t.t1),1),e("td",me,o(t.t2),1),e("td",_e,o(t.t3),1),e("td",ve,o(t.promedio),1)],2))),128))])])])):y("",!0),e("div",xe,[k(w,{label:"Volver al listado",small:"",color:"green",onClick:R}),x.value?y("",!0):(l(),F(w,{key:0,label:"Ver boleta",small:"",color:"blue",onClick:U}))])])):(l(),i("div",fe,[e("div",he,[H(e("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>p.value=t),type:"text",placeholder:"Buscar por nombre o curso...",class:"w-full md:w-1/2 px-4 py-2 border rounded shadow-sm"},null,512),[[G,p.value]])]),T.value?(l(),i("div",ye,"Cargando estudiantes...")):M.value?(l(),i("div",we,o(M.value),1)):(l(),i("table",ge,[s[11]||(s[11]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"p-2"},"Estudiante"),e("th",{class:"p-2"},"Curso"),e("th",{class:"p-2"},"Nivel"),e("th",{class:"p-2"},"Acciones")])],-1)),e("tbody",null,[(l(!0),i($,null,P(z.value,t=>{var a,_,c;return l(),i("tr",{key:t.id_estudiante},[e("td",Ce,o(t.nombre_completo),1),e("td",ke,o((a=t.curso)==null?void 0:a.grado_curso)+" "+o((_=t.curso)==null?void 0:_.paralelo_curso),1),e("td",Me,o((c=t.curso)==null?void 0:c.nivel),1),e("td",Le,[k(w,{label:"Ver Notas",small:"",color:"info",onClick:C=>I(t)},null,8,["onClick"])])])}),128))])])),L.value>1?(l(),i("div",$e,[k(w,{label:"« Anterior",small:"",disabled:f.value===1,onClick:s[2]||(s[2]=t=>f.value--)},null,8,["disabled"]),e("span",null,"Página "+o(f.value)+" de "+o(L.value),1),k(w,{label:"Siguiente »",small:"",disabled:f.value===L.value,onClick:s[3]||(s[3]=t=>f.value++)},null,8,["disabled"])])):y("",!0)]))])]}),_:1}))}};export{Ne as default};
