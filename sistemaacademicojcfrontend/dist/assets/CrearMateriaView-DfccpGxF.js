import{l as d,f as N,p as F,M as I,w as L,Q as h,H as x,o as l,a,d as S,c as o,x as u,v as j,J as _,Y as f,E as r,F as y,L as w,Z as z,D as P,e as k,q as R}from"./index-mF53A-2o.js";const T={class:"p-6 grid grid-cols-1 md:grid-cols-2 gap-6"},q={class:"bg-white p-6 rounded shadow"},H={key:0,class:"text-red-600 text-sm"},J={key:0,class:"text-red-600 text-sm"},Q={key:0,class:"text-red-600 text-sm"},Y=["value"],Z={key:0,class:"text-red-600 text-sm"},G={key:0,class:"mt-4 bg-blue-50 border p-3 rounded text-blue-700"},K={key:1,class:"mt-4 bg-yellow-50 border p-3 rounded text-yellow-800"},O={class:"list-disc ml-5"},W={class:"bg-white p-6 rounded shadow"},X={class:"space-y-2 max-h-[400px] overflow-y-auto pr-2"},ee={class:"font-semibold"},ae={class:"text-sm text-gray-600"},te={class:"text-sm text-gray-500"},se={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-[rgba(0,0,0,0.3)] backdrop-blur-sm"},le={class:"bg-white rounded-lg shadow-lg max-w-md w-full p-6 space-y-4"},re={class:"text-xs text-gray-500"},ie={class:"flex justify-end gap-2 mt-4"},oe=["disabled"],ue={__name:"CrearMateriaView",setup(ne){const s=d({sigla_materia:"",area_materia:"",campo_materia:"",nivel_educativo_id:""}),n=d({}),v=d([]),V=d(null),g=d([]),b=d(!1),c=d(!1),m=d(10),p=d(null),M=N(()=>{const i=g.value.find(e=>e.id===s.value.nivel_educativo_id);return s.value.sigla_materia&&i?`${s.value.sigla_materia} – ${i.nombre}`:null}),C=N(()=>s.value.area_materia?v.value.filter(i=>i.area_materia===s.value.area_materia&&i.sigla_materia!==s.value.sigla_materia):[]),$=async()=>{try{const i=await x.get("/materias");v.value=i.data.data}catch{console.error("Error al cargar materias")}},A=async()=>{try{const i=await x.get("/nivel-educativo");g.value=i.data.data}catch{console.error("Error al cargar niveles educativos")}};F(()=>{$(),A()});const U=async()=>{var i;n.value={};try{const e=await x.post("/materias",s.value);V.value=e.data.data,v.value.unshift(e.data.data),b.value=!0,s.value={sigla_materia:"",area_materia:"",campo_materia:"",nivel_educativo_id:""}}catch(e){((i=e.response)==null?void 0:i.status)===422?n.value=e.response.data.errors:console.error("Error al crear materia",e)}},B=()=>{m.value=10,c.value=!0,p.value&&clearInterval(p.value),p.value=setInterval(()=>{m.value>0?m.value--:clearInterval(p.value)},1e3)},D=()=>{c.value=!1,U()};return(i,e)=>(l(),I(h,null,{default:L(()=>[a("div",T,[a("div",q,[e[14]||(e[14]=a("h2",{class:"text-xl font-bold mb-4"},"Registrar nueva materia",-1)),a("form",{onSubmit:e[4]||(e[4]=j(()=>{},["prevent"])),class:"space-y-4"},[a("div",null,[e[7]||(e[7]=a("label",{class:"block text-sm font-medium mb-1"},"Sigla *",-1)),_(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>s.value.sigla_materia=t),class:"w-full border px-4 py-2 rounded"},null,512),[[f,s.value.sigla_materia]]),n.value.sigla_materia?(l(),o("span",H,r(n.value.sigla_materia[0]),1)):u("",!0)]),a("div",null,[e[8]||(e[8]=a("label",{class:"block text-sm font-medium mb-1"},"Campo *",-1)),_(a("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>s.value.campo_materia=t),class:"w-full border px-4 py-2 rounded"},null,512),[[f,s.value.campo_materia]]),n.value.campo_materia?(l(),o("span",J,r(n.value.campo_materia[0]),1)):u("",!0)]),a("div",null,[e[9]||(e[9]=a("label",{class:"block text-sm font-medium mb-1"},"Área *",-1)),_(a("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>s.value.area_materia=t),class:"w-full border px-4 py-2 rounded"},null,512),[[f,s.value.area_materia]]),n.value.area_materia?(l(),o("span",Q,r(n.value.area_materia[0]),1)):u("",!0)]),a("div",null,[e[11]||(e[11]=a("label",{class:"block text-sm font-medium mb-1"},"Nivel educativo *",-1)),_(a("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>s.value.nivel_educativo_id=t),class:"w-full border px-4 py-2 rounded"},[e[10]||(e[10]=a("option",{disabled:"",value:""},"Seleccione nivel",-1)),(l(!0),o(y,null,w(g.value,t=>(l(),o("option",{key:t.id,value:t.id},r(t.nombre),9,Y))),128))],512),[[z,s.value.nivel_educativo_id]]),n.value.nivel_educativo_id?(l(),o("span",Z,r(n.value.nivel_educativo_id[0]),1)):u("",!0)]),S(P,{type:"button",label:"Registrar",color:"success",class:"mt-4",onClick:B})],32),M.value?(l(),o("div",G,[e[12]||(e[12]=k(" Vista previa: ")),a("strong",null,r(M.value),1)])):u("",!0),C.value.length?(l(),o("div",K,[e[13]||(e[13]=a("p",{class:"font-medium mb-1"},"Materias similares:",-1)),a("ul",O,[(l(!0),o(y,null,w(C.value,t=>(l(),o("li",{key:t.id_materia},r(t.sigla_materia)+" – "+r(t.area_materia),1))),128))])])):u("",!0)]),a("div",W,[e[15]||(e[15]=a("h2",{class:"text-lg font-bold mb-4"},"Materias registradas",-1)),a("ul",X,[(l(!0),o(y,null,w(v.value,t=>{var E;return l(),o("li",{key:t.id_materia,class:"border px-4 py-2 rounded bg-gray-50"},[a("p",ee,r(t.sigla_materia),1),a("p",ae,r(t.area_materia)+" – "+r(t.campo_materia),1),a("p",te,r((E=t.nivel_educativo)==null?void 0:E.nombre),1)])}),128))])])]),S(R,{modelValue:b.value,"onUpdate:modelValue":e[5]||(e[5]=t=>b.value=t),title:"Materia registrada",button:"Aceptar",color:"success"},{default:L(()=>{var t;return[a("p",null,[e[16]||(e[16]=k(" La materia ")),a("strong",null,r((t=V.value)==null?void 0:t.sigla_materia),1),e[17]||(e[17]=k(" fue registrada correctamente. "))])]}),_:1},8,["modelValue"]),c.value?(l(),o("div",se,[a("div",le,[e[18]||(e[18]=a("h2",{class:"text-lg font-bold text-red-700"},"Advertencia legal",-1)),e[19]||(e[19]=a("p",{class:"text-sm text-gray-700"}," La modificación o creación de materias fuera del marco de la Ley N.º 070 puede contravenir la normativa vigente del sistema educativo boliviano. ",-1)),a("p",re," Lea esta advertencia. El botón se habilitará en "+r(m.value)+" segundos. ",1),a("div",ie,[a("button",{onClick:e[6]||(e[6]=t=>c.value=!1),class:"px-4 py-2 text-sm text-gray-700 border rounded hover:bg-gray-100"}," Cancelar "),a("button",{disabled:m.value>0,onClick:D,class:"px-4 py-2 text-sm text-white bg-red-600 rounded disabled:opacity-50"}," Proseguir ",8,oe)])])])):u("",!0)]),_:1}))}};export{ue as default};
