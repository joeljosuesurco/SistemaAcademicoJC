import{l as x,p as V,O as A,M,w as P,Q as F,H as T,o as n,a as e,c as p,x as k,J as O,Z as j,e as b,E as r,F as C,L as D,n as N,D as B}from"./index-CH035xVG.js";const H={class:"p-6"},I={key:0,class:"mb-6"},L={key:1,class:"bg-white border border-blue-200 rounded-xl shadow-md p-6 space-y-4"},R={class:"space-y-1 text-sm"},z={class:"overflow-x-auto"},J={class:"min-w-full text-center border border-gray-200 bg-white rounded-xl shadow-sm text-sm"},Q={class:"border px-4 py-2 text-left font-medium"},U={class:"border px-4 py-2"},Z={class:"border px-4 py-2"},q={class:"border px-4 py-2"},G={class:"border px-4 py-2"},K={class:"border px-4 py-2"},W={class:"border px-4 py-2"},X={class:"border px-4 py-2 font-bold text-blue-800"},Y={key:2,class:"overflow-x-auto mt-6"},ee={class:"space-y-1 text-sm mb-4"},te={class:"min-w-full text-center border border-gray-200 bg-white rounded-xl shadow-sm text-sm"},oe={class:"border px-4 py-2 text-left font-medium"},se={class:"border px-4 py-2"},re={class:"border px-4 py-2"},ae={class:"border px-4 py-2"},le={class:"border px-4 py-2 font-bold text-blue-700"},ne={class:"mt-6 flex gap-2"},ue={__name:"NotasEstudianteView",setup(de){const f=x([]),h=x([]),_=x("trimestre 1"),c=x(!1),i=x({nombre:"",curso:"",nivel:""});function E(d){const t=Math.round((d.ser_docente||0)*.05),o=Math.round((d.saber_docente||0)*.45),l=Math.round((d.hacer_docente||0)*.4),v=Math.round((d.decidir_docente||0)*.05),g=Math.round((d.ser_autoeval||0)*.05),w=Math.round((d.decidir_autoeval||0)*.05);return Math.min(t+o+l+v+g+w,100)}async function $(){var o;const[d,t]=_.value.split(" ");try{const l=await T.get("/estudiante-auth/notas",{params:{periodo:d,numero_periodo:t}}),v=l.data.data.notas,g=l.data.data.curso,w=l.data.data.nivel;if(!i.value.nombre){const s=(o=(await T.get("/perfil")).data.data.persona_rol)==null?void 0:o.persona,u=`${(s==null?void 0:s.apellidos_pat)||""} ${(s==null?void 0:s.apellidos_mat)||""} ${(s==null?void 0:s.nombres_persona)||""}`.trim();i.value={nombre:u,curso:g,nivel:w}}f.value=v.map(a=>{const s=Object.fromEntries(a.dimensiones.map(u=>[u.nombre_dimension,u.valor_obtenido]));return{nombre:`${a.materia.area_materia} (${a.materia.sigla_materia})`,ser:s.ser_docente||0,saber:s.saber_docente||0,hacer:s.hacer_docente||0,decidir:s.decidir_docente||0,ser_auto:s.ser_autoeval||0,decidir_auto:s.decidir_autoeval||0,promedio:E(s)}});const y=new Map;v.forEach(a=>{const s=Object.fromEntries(a.dimensiones.map(S=>[S.nombre_dimension,S.valor_obtenido])),u=E(s),m=a.materia.id_materia;y.has(m)||y.set(m,{nombre:`${a.materia.area_materia} (${a.materia.sigla_materia})`,t1:0,t2:0,t3:0}),y.get(m)[`t${a.numero_periodo}`]=u}),h.value=Array.from(y.values()).map(a=>{const s=a.t1+a.t2+a.t3,u=[a.t1,a.t2,a.t3].filter(m=>m>0).length||1;return{...a,promedio:Math.min(Math.round(s/u),100)}})}catch(l){console.error("Error al cargar notas:",l)}}return V(()=>{$()}),A(_,$),(d,t)=>(n(),M(F,null,{default:P(()=>[e("div",H,[t[14]||(t[14]=e("h2",{class:"text-xl font-bold mb-6"},"Mis Notas",-1)),c.value?k("",!0):(n(),p("div",I,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium mb-1"},"Periodo",-1)),O(e("select",{"onUpdate:modelValue":t[0]||(t[0]=o=>_.value=o),class:"px-3 py-2 border rounded shadow-sm w-52"},t[3]||(t[3]=[e("option",{value:"trimestre 1"},"Trimestre 1",-1),e("option",{value:"trimestre 2"},"Trimestre 2",-1),e("option",{value:"trimestre 3"},"Trimestre 3",-1)]),512),[[j,_.value]])])),f.value.length&&!c.value?(n(),p("div",L,[e("div",R,[e("p",null,[t[5]||(t[5]=e("strong",null,"Estudiante:",-1)),b(" "+r(i.value.nombre),1)]),e("p",null,[t[6]||(t[6]=e("strong",null,"Curso:",-1)),b(" "+r(i.value.curso),1)]),e("p",null,[t[7]||(t[7]=e("strong",null,"Nivel:",-1)),b(" "+r(i.value.nivel),1)])]),e("div",z,[e("table",J,[t[8]||(t[8]=e("thead",null,[e("tr",null,[e("th",{rowspan:"3",class:"border px-4 py-2 font-semibold text-blue-800 bg-blue-50"}," MATERIAS "),e("th",{colspan:"4",class:"border px-4 py-2 font-semibold bg-blue-100 text-blue-700"}," Evaluación Maestro(a) "),e("th",{colspan:"2",class:"border px-4 py-2 font-semibold bg-purple-100 text-purple-700"}," Autoevaluación "),e("th",{rowspan:"3",class:"border px-4 py-2 font-semibold text-blue-800 bg-blue-50"}," Promedio ")]),e("tr",null,[e("th",{colspan:"4",class:"border px-4 py-2 font-medium bg-blue-200 text-blue-600"}," Dimensiones "),e("th",{colspan:"2",class:"border px-4 py-2 font-medium bg-purple-200 text-purple-700"}," Dimensiones ")]),e("tr",null,[e("th",{class:"border px-4 py-2 font-medium text-blue-700"},"Ser"),e("th",{class:"border px-4 py-2 font-medium text-blue-700"},"Saber"),e("th",{class:"border px-4 py-2 font-medium text-blue-700"},"Hacer"),e("th",{class:"border px-4 py-2 font-medium text-blue-700"},"Decidir"),e("th",{class:"border px-4 py-2 font-medium text-purple-700"},"Ser"),e("th",{class:"border px-4 py-2 font-medium text-purple-700"},"Decidir")])],-1)),e("tbody",null,[(n(!0),p(C,null,D(f.value,(o,l)=>(n(),p("tr",{key:l,class:N(l%2===0?"bg-white":"bg-gray-50")},[e("td",Q,r(o.nombre),1),e("td",U,r(o.ser),1),e("td",Z,r(o.saber),1),e("td",q,r(o.hacer),1),e("td",G,r(o.decidir),1),e("td",K,r(o.ser_auto),1),e("td",W,r(o.decidir_auto),1),e("td",X,r(o.promedio),1)],2))),128))])])])])):k("",!0),h.value.length&&c.value?(n(),p("div",Y,[e("div",ee,[e("p",null,[t[9]||(t[9]=e("strong",null,"Estudiante:",-1)),b(" "+r(i.value.nombre),1)]),e("p",null,[t[10]||(t[10]=e("strong",null,"Curso:",-1)),b(" "+r(i.value.curso),1)]),e("p",null,[t[11]||(t[11]=e("strong",null,"Nivel:",-1)),b(" "+r(i.value.nivel),1)])]),t[13]||(t[13]=e("h3",{class:"text-xl font-semibold mb-4 text-blue-700"},"Boleta de Calificaciones",-1)),e("table",te,[t[12]||(t[12]=e("thead",{class:"bg-blue-50 text-blue-800"},[e("tr",null,[e("th",{class:"border px-4 py-2 font-semibold"},"MATERIAS"),e("th",{class:"border px-4 py-2"},"1er Trim"),e("th",{class:"border px-4 py-2"},"2do Trim"),e("th",{class:"border px-4 py-2"},"3er Trim"),e("th",{class:"border px-4 py-2"},"Promedio Final")])],-1)),e("tbody",null,[(n(!0),p(C,null,D(h.value,(o,l)=>(n(),p("tr",{key:l,class:N(l%2===0?"bg-white":"bg-gray-50")},[e("td",oe,r(o.nombre),1),e("td",se,r(o.t1),1),e("td",re,r(o.t2),1),e("td",ae,r(o.t3),1),e("td",le,r(o.promedio),1)],2))),128))])])])):k("",!0),e("div",ne,[c.value?(n(),M(B,{key:0,label:"Volver al listado",small:"",color:"green",onClick:t[1]||(t[1]=o=>c.value=!1)})):(n(),M(B,{key:1,label:"Ver boleta",small:"",color:"blue",onClick:t[2]||(t[2]=o=>c.value=!0)}))])])]),_:1}))}};export{ue as default};
