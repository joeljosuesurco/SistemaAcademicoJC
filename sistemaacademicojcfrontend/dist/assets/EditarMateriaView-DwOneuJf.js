import{l,m as Z,f as K,p as W,M as A,w as X,Q as ee,H as f,o as i,a as e,c as d,x as c,J as _,Y as $,F,L as q,n as G,E as o,d as P,D as j,Z as ae,e as T}from"./index-CH035xVG.js";const te={class:"p-6"},se={key:0},le={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ie={class:"bg-white p-6 rounded shadow-md"},re={class:"overflow-auto max-h-[500px] border rounded"},oe={class:"min-w-full text-sm"},ne=["onClick"],de={class:"px-4 py-2"},ue={class:"px-4 py-2"},ce={class:"px-4 py-2"},ve={class:"px-4 py-2"},me={class:"px-4 py-2"},pe={key:1,class:"bg-white p-6 rounded shadow-md"},be={class:"flex justify-between items-center mb-4"},xe={class:"text-xl font-semibold"},ge={class:"grid md:grid-cols-2 gap-4 mb-6"},fe=["value"],_e={class:"flex gap-4"},ye={key:0,class:"text-green-600 mt-2"},we={key:1,class:"text-red-600 mt-2"},ke={key:2,class:"fixed inset-0 z-50 flex items-center justify-center bg-[rgba(0,0,0,0.3)] backdrop-blur-sm"},he={class:"bg-white rounded-lg shadow-lg max-w-md w-full p-6 space-y-4"},Ce={class:"flex justify-end gap-2 mt-4"},$e={key:3,class:"fixed inset-0 z-50 flex items-center justify-center bg-[rgba(0,0,0,0.3)] backdrop-blur-sm"},je={class:"bg-white rounded-lg shadow-lg max-w-md w-full p-6 space-y-4"},Ee={class:"text-lg font-bold text-green-700"},Me={class:"flex justify-end gap-2 mt-4"},ze={key:4,class:"fixed inset-0 z-50 flex items-center justify-center bg-[rgba(0,0,0,0.3)] backdrop-blur-sm"},Le={class:"bg-white rounded-lg shadow-lg max-w-md w-full p-6 space-y-4"},Ve={class:"flex justify-end mt-4"},Ae={key:5,class:"fixed inset-0 z-50 flex items-center justify-center bg-[rgba(0,0,0,0.3)] backdrop-blur-sm"},Ne={class:"bg-white rounded-lg shadow-lg max-w-md w-full p-6 space-y-4"},Se={class:"text-xs text-gray-500"},Be={class:"flex justify-end gap-2 mt-4"},De=["disabled"],qe={__name:"EditarMateriaView",setup(Ie){const E=l([]),r=l(null),N=l([]),y=l(""),u=l(""),w=l(""),n=Z({sigla_materia:"",campo_materia:"",area_materia:"",nivel_educativo_id:""}),v=l(!1),m=l(!1),M=l(""),z=l(!1),p=l(""),k=l(!1),L=l(""),b=l(10),h=l(null),H=K(()=>{if(!w.value)return E.value;const s=w.value.toLowerCase();return E.value.filter(a=>{var x,g;return a.sigla_materia.toLowerCase().includes(s)||a.area_materia.toLowerCase().includes(s)||a.campo_materia.toLowerCase().includes(s)||((g=(x=a.nivel_educativo)==null?void 0:x.nombre)==null?void 0:g.toLowerCase().includes(s))})}),J=s=>{r.value=s,Object.assign(n,{sigla_materia:s.sigla_materia,campo_materia:s.campo_materia,area_materia:s.area_materia,nivel_educativo_id:s.nivel_educativo_id}),y.value="",u.value=""},V=s=>{L.value=s,b.value=10,k.value=!0,h.value&&clearInterval(h.value),h.value=setInterval(()=>{b.value>0?b.value--:clearInterval(h.value)},1e3)},O=()=>{k.value=!1,L.value==="guardar"?Q():L.value==="reactivar"&&S(!0)},Q=async()=>{if(r.value)try{const s=await f.put(`/materias/${r.value.id_materia}`,n);p.value=s.data.message||"Materia actualizada correctamente.",v.value=!0,await C()}catch{u.value="Error al actualizar la materia.",p.value=""}finally{z.value=!1}},R=()=>{r.value=null,y.value="",u.value=""},S=async(s=!1)=>{if(r.value)try{const a=r.value.id_materia;M.value==="inhabilitar"?(await f.put(`/materias/${a}/inhabilitar`),r.value.estado="inactivo",p.value=`Materia "${r.value.sigla_materia}" inhabilitada correctamente.`,v.value=!0,await C(),m.value=!1):M.value==="reactivar"&&(s?(await f.put(`/materias/${a}/reactivar`),r.value.estado="activo",p.value=`Materia "${r.value.sigla_materia}" reactivada correctamente.`,v.value=!0,await C(),m.value=!1):V("reactivar"))}catch{u.value="Error al realizar la acción."}},B=s=>{M.value=s,s==="reactivar"?V("reactivar"):m.value=!0},D=()=>{V("guardar")},C=async()=>{try{const s=await f.get("/admin/materias");E.value=s.data.data}catch{u.value="Error al cargar materias"}},Y=async()=>{try{const s=await f.get("/nivel-educativo");N.value=s.data.data}catch{console.error("Error al cargar niveles educativos")}};return W(()=>{C(),Y()}),(s,a)=>(i(),A(ee,null,{default:X(()=>{var x,g;return[e("div",te,[a[25]||(a[25]=e("h1",{class:"text-2xl font-bold mb-6"},"Administrar Materias",-1)),r.value?(i(),d("div",pe,[e("div",be,[e("h2",xe," Editar materia: "+o(n.sigla_materia)+" ("+o((g=(x=r.value)==null?void 0:x.nivel_educativo)==null?void 0:g.nombre)+") ",1),P(j,{label:"Cancelar",color:"secondary",onClick:R})]),e("div",ge,[e("div",null,[a[14]||(a[14]=e("label",{class:"block text-sm font-medium mb-1"},"Sigla",-1)),_(e("input",{"onUpdate:modelValue":a[1]||(a[1]=t=>n.sigla_materia=t),class:"w-full border px-4 py-2 rounded"},null,512),[[$,n.sigla_materia]])]),e("div",null,[a[15]||(a[15]=e("label",{class:"block text-sm font-medium mb-1"},"Área",-1)),_(e("input",{"onUpdate:modelValue":a[2]||(a[2]=t=>n.area_materia=t),class:"w-full border px-4 py-2 rounded"},null,512),[[$,n.area_materia]])]),e("div",null,[a[16]||(a[16]=e("label",{class:"block text-sm font-medium mb-1"},"Campo",-1)),_(e("input",{"onUpdate:modelValue":a[3]||(a[3]=t=>n.campo_materia=t),class:"w-full border px-4 py-2 rounded"},null,512),[[$,n.campo_materia]])]),e("div",null,[a[18]||(a[18]=e("label",{class:"block text-sm font-medium mb-1"},"Nivel educativo",-1)),_(e("select",{"onUpdate:modelValue":a[4]||(a[4]=t=>n.nivel_educativo_id=t),class:"w-full border px-4 py-2 rounded"},[a[17]||(a[17]=e("option",{disabled:"",value:""},"Seleccione nivel",-1)),(i(!0),d(F,null,q(N.value,t=>(i(),d("option",{key:t.id,value:t.id},o(t.nombre),9,fe))),128))],512),[[ae,n.nivel_educativo_id]])])]),e("div",_e,[P(j,{label:"Guardar cambios",color:"success",onClick:D}),r.value.estado==="activo"?(i(),A(j,{key:0,label:"Inhabilitar materia",color:"danger",onClick:a[5]||(a[5]=t=>B("inhabilitar"))})):(i(),A(j,{key:1,label:"Reactivar materia",color:"warning",onClick:a[6]||(a[6]=t=>B("reactivar"))}))]),y.value?(i(),d("div",ye,o(y.value),1)):c("",!0),u.value?(i(),d("div",we,o(u.value),1)):c("",!0)])):(i(),d("div",se,[e("div",le,[e("div",ie,[a[13]||(a[13]=e("h2",{class:"text-xl font-semibold mb-4"},"Listado de materias",-1)),_(e("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>w.value=t),type:"text",placeholder:"Buscar por sigla, campo, área o nivel",class:"w-full mb-4 px-4 py-2 border rounded shadow-sm"},null,512),[[$,w.value]]),e("div",re,[e("table",oe,[a[12]||(a[12]=e("thead",{class:"bg-gray-100 sticky top-0"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"Sigla"),e("th",{class:"px-4 py-2 text-left"},"Área"),e("th",{class:"px-4 py-2 text-left"},"Campo"),e("th",{class:"px-4 py-2 text-left"},"Nivel"),e("th",{class:"px-4 py-2 text-left"},"Estado")])],-1)),e("tbody",null,[(i(!0),d(F,null,q(H.value,t=>{var I,U;return i(),d("tr",{key:t.id_materia,onClick:Ue=>J(t),class:G(["cursor-pointer",((I=r.value)==null?void 0:I.id_materia)===t.id_materia?"bg-blue-100":"hover:bg-gray-50"])},[e("td",de,o(t.sigla_materia),1),e("td",ue,o(t.area_materia),1),e("td",ce,o(t.campo_materia),1),e("td",ve,o((U=t.nivel_educativo)==null?void 0:U.nombre),1),e("td",me,[e("span",{class:G([t.estado==="activo"?"text-green-600":"text-red-600","font-medium"])},o(t.estado),3)])],10,ne)}),128))])])])])])])),m.value?(i(),d("div",ke,[e("div",he,[a[19]||(a[19]=e("h2",{class:"text-lg font-bold text-red-700"},"¿Desea inhabilitar esta materia?",-1)),e("div",Ce,[e("button",{onClick:a[7]||(a[7]=t=>m.value=!1),class:"px-4 py-2 text-sm text-gray-700 border rounded hover:bg-gray-100"}," Cancelar "),e("button",{onClick:a[8]||(a[8]=t=>S()),class:"px-4 py-2 text-sm text-white bg-red-600 rounded"}," Inhabilitar ")])])])):c("",!0),z.value?(i(),d("div",$e,[e("div",je,[e("h2",Ee,[a[20]||(a[20]=T(" ¿Desea guardar los cambios de la materia ")),e("strong",null,o(n.sigla_materia),1),a[21]||(a[21]=T("? "))]),e("div",Me,[e("button",{onClick:a[9]||(a[9]=t=>z.value=!1),class:"px-4 py-2 text-sm text-gray-700 border rounded hover:bg-gray-100"}," Cancelar "),e("button",{onClick:D,class:"px-4 py-2 text-sm text-white bg-green-600 rounded"}," Guardar ")])])])):c("",!0),v.value?(i(),d("div",ze,[e("div",Le,[a[22]||(a[22]=e("h2",{class:"text-lg font-bold text-blue-700"},"Materia actualizada",-1)),e("p",null,o(p.value),1),e("div",Ve,[e("button",{onClick:a[10]||(a[10]=t=>v.value=!1),class:"px-4 py-2 text-sm text-white bg-blue-600 rounded"}," Aceptar ")])])])):c("",!0),k.value?(i(),d("div",Ae,[e("div",Ne,[a[23]||(a[23]=e("h2",{class:"text-lg font-bold text-red-700"},"Advertencia legal",-1)),a[24]||(a[24]=e("p",{class:"text-sm text-gray-700"}," La modificación o creación de materias fuera del marco de la Ley N.º 070 puede contravenir la normativa vigente del sistema educativo boliviano. ",-1)),e("p",Se," Lea esta advertencia. El botón se habilitará en "+o(b.value)+" segundos. ",1),e("div",Be,[e("button",{onClick:a[11]||(a[11]=t=>k.value=!1),class:"px-4 py-2 text-sm text-gray-700 border rounded hover:bg-gray-100"}," Cancelar "),e("button",{disabled:b.value>0,onClick:O,class:"px-4 py-2 text-sm text-white bg-red-600 rounded disabled:opacity-50"}," Proseguir ",8,De)])])])):c("",!0)])]}),_:1}))}};export{qe as default};
