import{l as r,p as J,H as M,O,M as Q,w as B,Q as Y,o as n,a as t,d as x,c as i,q as A,E as u,F as U,L as N,D as P,t as Z,J as p,Z as K,e as g,n as h,Y as f}from"./index-B8rY39Xw.js";const W={class:"p-6"},X={class:"text-green-700"},ee={key:0},te={class:"grid md:grid-cols-2 lg:grid-cols-3 gap-4"},oe=["onClick"],se={class:"font-semibold"},ae={class:"text-sm text-gray-600"},le={class:"text-sm text-gray-600"},re={key:1},ne={class:"mb-4"},de={class:"grid md:grid-cols-2 lg:grid-cols-3 gap-4"},ie=["onClick"],ue={class:"font-semibold"},ce={class:"text-sm text-gray-600"},me={key:2},_e={class:"mb-4 flex justify-between items-center"},be={class:"flex gap-2 items-center"},pe={class:"overflow-x-auto"},ve={class:"w-full text-sm text-center bg-white rounded shadow border"},xe={class:"px-2 py-1 font-medium"},ge=["onUpdate:modelValue","onBlur"],he=["onUpdate:modelValue","onBlur"],fe=["onUpdate:modelValue","onBlur"],ye=["onUpdate:modelValue","onBlur"],Ve=["onUpdate:modelValue","onBlur"],we=["onUpdate:modelValue","onBlur"],Ce={class:"font-bold text-blue-800"},F="trimestre",$e={__name:"RegistrarNotaProfesorView",setup(ke){const S=r([]),y=r([]),c=r(null),_=r(null),V=r(1),$=r(""),E=r(""),w=r(!1),C=r(!1),H=r("¿Registrar o modificar notas de todos los estudiantes?"),D=r(null),l=r({}),I=s=>{c.value=s,_.value=null,y.value=[],l.value={}},T=async s=>{_.value=s;const o=await M.get("/adsolo/notas/estudiantes",{params:{curso_id:c.value.id_curso,materia_id:s.id_materia,periodo:F,numero_periodo:V.value}});y.value=o.data.data.map(e=>({id:e.id_estudiante,nombre:e.nombre_completo,ser:e.ser||"",saber:e.saber||"",hacer:e.hacer||"",decidir:e.decidir||"",ser_auto:e.ser_auto||"",decidir_auto:e.decidir_auto||""})),l.value={}},v=(s,o,e)=>{const m=e.replace(/[^0-9]/g,""),d=parseInt(m),b=!isNaN(d)&&d>=0&&d<=100;return l.value[s]||(l.value[s]={}),l.value[s][o]=!b,b?d:""},L=s=>{const o=Math.round((s.ser||0)*.05),e=Math.round((s.saber||0)*.45),m=Math.round((s.hacer||0)*.4),d=Math.round((s.decidir||0)*.05),b=Math.round((s.ser_auto||0)*.05),k=Math.round((s.decidir_auto||0)*.05);return Math.min(o+e+m+d+b+k,100)},q=()=>{D.value=z,w.value=!0},z=async()=>{w.value=!1,$.value="",E.value="";try{for(const s of y.value){const o={estudiante_id:s.id,materia_id:_.value.id_materia,curso_id:c.value.id_curso,gestion_id:c.value.id_gestion,periodo:F,numero_periodo:V.value,dimensiones:[{nombre_dimension:"ser_docente",valor_obtenido:s.ser},{nombre_dimension:"saber_docente",valor_obtenido:s.saber},{nombre_dimension:"hacer_docente",valor_obtenido:s.hacer},{nombre_dimension:"decidir_docente",valor_obtenido:s.decidir},{nombre_dimension:"ser_autoeval",valor_obtenido:s.ser_auto},{nombre_dimension:"decidir_autoeval",valor_obtenido:s.decidir_auto}]};await M.post("/adsolo/notas",o)}$.value="Notas registradas exitosamente",C.value=!0}catch(s){console.error(s),E.value="Error al registrar notas. Intente nuevamente."}},G=()=>{_.value=null,y.value=[],l.value={}};return J(async()=>{const s=await M.get("/adsolo/cursos-con-materias");S.value=s.data.data.map(o=>{var e;return{...o,nombre:`${o.grado_curso} ${o.paralelo_curso}`,nivel:((e=o.nivel_educativo)==null?void 0:e.nombre)||""}})}),O(V,()=>{c.value&&_.value&&T(_.value)}),(s,o)=>(n(),Q(Y,null,{default:B(()=>[t("div",W,[o[10]||(o[10]=t("h2",{class:"text-2xl font-bold mb-6"},"Registrar Notas por Curso",-1)),x(A,{modelValue:w.value,"onUpdate:modelValue":o[0]||(o[0]=e=>w.value=e),title:H.value,button:"success","button-label":"Confirmar","has-cancel":!0,onConfirm:D.value},{default:B(()=>o[5]||(o[5]=[t("p",null,"Esta acción modificará las notas de todos los estudiantes. ¿Está seguro?",-1)])),_:1},8,["modelValue","title","onConfirm"]),x(A,{modelValue:C.value,"onUpdate:modelValue":o[1]||(o[1]=e=>C.value=e),title:"Éxito",button:"success","button-label":"Aceptar","has-cancel":!1,onConfirm:o[2]||(o[2]=e=>C.value=!1)},{default:B(()=>[t("p",X,u($.value),1)]),_:1},8,["modelValue"]),c.value?_.value?(n(),i("div",me,[x(Z,{class:"mt-4"},{default:B(()=>[t("div",_e,[t("div",be,[x(P,{label:"Volver",color:"gray",small:"",onClick:G}),p(t("select",{"onUpdate:modelValue":o[4]||(o[4]=e=>V.value=e),class:"pl-3 pr-8 py-2 rounded border text-sm"},o[8]||(o[8]=[t("option",{value:"1"},"Trimestre 1",-1),t("option",{value:"2"},"Trimestre 2",-1),t("option",{value:"3"},"Trimestre 3",-1)]),512),[[K,V.value]])]),x(P,{label:"Registrar Notas",color:"primary",onClick:q})]),t("div",pe,[t("table",ve,[o[9]||(o[9]=t("thead",null,[t("tr",null,[t("th",{rowspan:"2",class:"bg-blue-50 text-blue-800 font-bold px-4 py-2"}," Estudiante "),t("th",{colspan:"4",class:"bg-blue-100 text-blue-800 font-semibold"}," Evaluación Docente "),t("th",{colspan:"2",class:"bg-purple-100 text-purple-800 font-semibold"}," Autoevaluación "),t("th",{rowspan:"2",class:"bg-blue-50 text-blue-800 font-bold px-2"},"Promedio")]),t("tr",null,[t("th",{class:"bg-blue-50 text-blue-700"},[g(" Ser"),t("br"),t("span",{class:"text-xs"},"(5 Pts.)")]),t("th",{class:"bg-blue-50 text-blue-700"},[g(" Saber"),t("br"),t("span",{class:"text-xs"},"(45 Pts.)")]),t("th",{class:"bg-blue-50 text-blue-700"},[g(" Hacer"),t("br"),t("span",{class:"text-xs"},"(40 Pts.)")]),t("th",{class:"bg-blue-50 text-blue-700"},[g(" Decidir"),t("br"),t("span",{class:"text-xs"},"(5 Pts.)")]),t("th",{class:"bg-purple-50 text-purple-700"},[g(" Ser"),t("br"),t("span",{class:"text-xs"},"(5 Pts.)")]),t("th",{class:"bg-purple-50 text-purple-700"},[g(" Decidir"),t("br"),t("span",{class:"text-xs"},"(5 Pts.)")])])],-1)),t("tbody",null,[(n(!0),i(U,null,N(y.value,e=>{var m,d,b,k,R,j;return n(),i("tr",{key:e.id,class:"border-t"},[t("td",xe,u(e.nombre),1),t("td",null,[p(t("input",{type:"text",class:h(["w-16 text-center border rounded",{"border-red-500":(m=l.value[e.id])==null?void 0:m.ser}]),"onUpdate:modelValue":a=>e.ser=a,onBlur:a=>v(e.id,"ser",e.ser)},null,42,ge),[[f,e.ser]])]),t("td",null,[p(t("input",{type:"text",class:h(["w-16 text-center border rounded",{"border-red-500":(d=l.value[e.id])==null?void 0:d.saber}]),"onUpdate:modelValue":a=>e.saber=a,onBlur:a=>v(e.id,"saber",e.saber)},null,42,he),[[f,e.saber]])]),t("td",null,[p(t("input",{type:"text",class:h(["w-16 text-center border rounded",{"border-red-500":(b=l.value[e.id])==null?void 0:b.hacer}]),"onUpdate:modelValue":a=>e.hacer=a,onBlur:a=>v(e.id,"hacer",e.hacer)},null,42,fe),[[f,e.hacer]])]),t("td",null,[p(t("input",{type:"text",class:h(["w-16 text-center border rounded",{"border-red-500":(k=l.value[e.id])==null?void 0:k.decidir}]),"onUpdate:modelValue":a=>e.decidir=a,onBlur:a=>v(e.id,"decidir",e.decidir)},null,42,ye),[[f,e.decidir]])]),t("td",null,[p(t("input",{type:"text",class:h(["w-16 text-center border rounded",{"border-red-500":(R=l.value[e.id])==null?void 0:R.ser_auto}]),"onUpdate:modelValue":a=>e.ser_auto=a,onBlur:a=>v(e.id,"ser_auto",e.ser_auto)},null,42,Ve),[[f,e.ser_auto]])]),t("td",null,[p(t("input",{type:"text",class:h(["w-16 text-center border rounded",{"border-red-500":(j=l.value[e.id])==null?void 0:j.decidir_auto}]),"onUpdate:modelValue":a=>e.decidir_auto=a,onBlur:a=>v(e.id,"decidir_auto",e.decidir_auto)},null,42,we),[[f,e.decidir_auto]])]),t("td",Ce,u(L(e)),1)])}),128))])])])]),_:1})])):(n(),i("div",re,[t("div",ne,[x(P,{label:"Volver a cursos",color:"gray",small:"",onClick:o[3]||(o[3]=e=>c.value=null)})]),o[7]||(o[7]=t("h3",{class:"text-xl font-semibold mb-4"},"Seleccione una materia",-1)),t("div",de,[(n(!0),i(U,null,N(c.value.materias,e=>(n(),i("div",{key:e.id_materia,class:"p-4 border rounded shadow bg-blue-50 hover:bg-blue-100 cursor-pointer",onClick:m=>T(e)},[t("p",ue,u(e.area_materia)+" ("+u(e.sigla_materia)+")",1),t("p",ce,"Campo: "+u(e.campo_materia),1)],8,ie))),128))])])):(n(),i("div",ee,[o[6]||(o[6]=t("h3",{class:"text-lg font-semibold mb-2"},"Seleccione un curso",-1)),t("div",te,[(n(!0),i(U,null,N(S.value,e=>(n(),i("div",{key:e.id_curso,class:"p-4 border rounded shadow bg-indigo-50 hover:bg-indigo-100 cursor-pointer",onClick:m=>I(e)},[t("p",se,u(e.nombre),1),t("p",ae,"Nivel: "+u(e.nivel),1),t("p",le,"Gestión: "+u(e.gestion),1)],8,oe))),128))])]))])]),_:1}))}};export{$e as default};
