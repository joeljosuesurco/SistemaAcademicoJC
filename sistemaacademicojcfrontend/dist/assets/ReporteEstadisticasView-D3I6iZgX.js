import{a4 as V,ad as M,ae as P,af as R,a9 as A,aa as L,l as r,p as N,H as p,M as w,w as F,Q as G,o as s,a as i,c as u,x as b,d as _,D as y,J as $,F as S,L as E,E as v,Z as h,u as U,ag as Z}from"./index-CH035xVG.js";const H={class:"p-6 space-y-6"},J={class:"bg-white border rounded shadow p-4 space-y-4"},O={class:"flex gap-4"},Q={key:0,class:"grid md:grid-cols-2 gap-4"},T=["value"],j=["value"],q={key:0,class:"text-red-600"},z={key:1,class:"text-gray-500"},W={__name:"ReporteEstadisticasView",setup(I){V.register(M,P,R,A,L);const o=r("materias"),C=r([]),x=r([]),m=r(""),g=r(""),n=r([]),f=r(!1),d=r(""),c=r(null),B={responsive:!0,indexAxis:"y",plugins:{legend:{position:"top"}},scales:{x:{beginAtZero:!0,max:5}}};N(async()=>{try{const l=await p.get("/cursos");C.value=l.data.data;const e=await p.get("/materias");x.value=e.data.data}catch{d.value="Error al cargar cursos o materias"}});const D=async()=>{f.value=!0,d.value="",n.value=[],c.value=null;try{let l;if(o.value==="materias")l=await p.get("/reportes/rendimiento/materias"),n.value=l.data.data,c.value=k(n.value,"materia");else if(o.value==="cursos")l=await p.get("/reportes/rendimiento/cursos"),n.value=l.data.data,c.value=k(n.value,"curso");else if(o.value==="estudiantes"){if(!m.value||!g.value){d.value="Selecciona curso y materia",f.value=!1;return}l=await p.get(`/reportes/rendimiento/estudiantes/${m.value}/${g.value}`),n.value=l.data.data,c.value=k(n.value,"estudiante")}}catch{d.value="Error al generar reporte"}finally{f.value=!1}};function k(l,e){let a=[];return e==="materia"?a=l.map(t=>`${t.area_materia} (${t.nivel_educativo_nombre})`):e==="curso"?a=l.map(t=>`${t.grado_curso} ${t.paralelo_curso}`):a=l.map(t=>t.nombre_completo),{labels:a,datasets:[{label:"Asistencia",data:l.map(t=>t.asistencia),backgroundColor:"#6366f1"},{label:"Participación",data:l.map(t=>t.participacion),backgroundColor:"#3b82f6"},{label:"Disciplina",data:l.map(t=>t.disciplina),backgroundColor:"#10b981"},{label:"Puntualidad",data:l.map(t=>t.puntualidad),backgroundColor:"#f59e0b"},{label:"Respeto",data:l.map(t=>t.respeto),backgroundColor:"#8b5cf6"},{label:"Tolerancia",data:l.map(t=>t.tolerancia),backgroundColor:"#ec4899"},{label:"Estado de ánimo",data:l.map(t=>t.estado_animo),backgroundColor:"#ef4444"}]}}return(l,e)=>(s(),w(G,null,{default:F(()=>[i("div",H,[e[7]||(e[7]=i("h1",{class:"text-2xl font-bold"},"Reportes de Rendimiento",-1)),i("div",J,[i("div",O,[_(y,{label:"Por Materia",onClick:e[0]||(e[0]=a=>o.value="materias"),color:o.value==="materias"?"primary":"default"},null,8,["color"]),_(y,{label:"Por Curso",onClick:e[1]||(e[1]=a=>o.value="cursos"),color:o.value==="cursos"?"primary":"default"},null,8,["color"]),_(y,{label:"Por Estudiante",onClick:e[2]||(e[2]=a=>o.value="estudiantes"),color:o.value==="estudiantes"?"primary":"default"},null,8,["color"])]),o.value==="estudiantes"?(s(),u("div",Q,[$(i("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>m.value=a),class:"w-full px-4 py-2 border rounded"},[e[5]||(e[5]=i("option",{value:""},"Seleccionar curso",-1)),(s(!0),u(S,null,E(C.value,a=>(s(),u("option",{key:a.id_curso,value:a.id_curso},v(a.grado_curso)+" "+v(a.paralelo_curso)+" - "+v(a.nivel_educativo.codigo),9,T))),128))],512),[[h,m.value]]),$(i("select",{"onUpdate:modelValue":e[4]||(e[4]=a=>g.value=a),class:"w-full px-4 py-2 border rounded"},[e[6]||(e[6]=i("option",{value:""},"Seleccionar materia",-1)),(s(!0),u(S,null,E(x.value,a=>(s(),u("option",{key:a.id_materia,value:a.id_materia},v(a.sigla_materia)+" - "+v(a.area_materia),9,j))),128))],512),[[h,g.value]])])):b("",!0),i("div",null,[_(y,{label:"Generar",color:"success",onClick:D})])]),d.value?(s(),u("div",q,v(d.value),1)):b("",!0),f.value?(s(),u("div",z,"Generando...")):b("",!0),c.value?(s(),w(U(Z),{key:2,data:c.value,options:B,style:{"max-height":"500px"}},null,8,["data"])):b("",!0)])]),_:1}))}};export{W as default};
