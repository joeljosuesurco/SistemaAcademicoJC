import{$ as N,l as d,M as C,w as s,Q as S,s as j,o as c,d as i,S as k,T as M,t as q,a as t,v as B,c as b,x as V,J as f,Z as m,D as I,E as w,H as p}from"./index-BqRVU6QF.js";import{_ as n,a as v}from"./FormControl-BE_YjS_i.js";const P={key:0,class:"text-green-600 mt-2"},T={key:1,class:"text-red-600 mt-2"},Q={__name:"CrearNotificacionView",setup(D){const g=j(),_=N(),a=d({titulo_notificacion:"",mensaje_notificacion:"",fecha_notificacion:"",estado_notificacion:"activo",tipo_notificacion:"publico",grupo_destino:"todos"}),l=d(""),u=d(""),y=async()=>{var r,e;try{const o=_.userId;if(!o)throw new Error("Usuario no identificado");const U=(await p.post("/notificaciones",{...a.value,users_id_user:o})).data.data.id_notificacion,$=a.value.grupo_destino,x=(await p.get(`/usuarios-por-grupo/${$}`)).data.data.map(E=>E.id_user);await p.post("/asignar-notificacion",{notificaciones_id_notificacion:U,usuarios:x}),await _.fetchComunicadosVisibles(),l.value="Notificación enviada correctamente.",u.value="",g.push("/comunicados")}catch(o){l.value="",u.value=((e=(r=o.response)==null?void 0:r.data)==null?void 0:e.message)||o.message}};return(r,e)=>(c(),C(S,null,{default:s(()=>[i(k,null,{default:s(()=>[i(M,{title:"Nuevo Comunicado"}),i(q,null,{default:s(()=>[t("form",{onSubmit:B(y,["prevent"]),class:"space-y-4"},[i(n,{label:"Título"},{default:s(()=>[i(v,{modelValue:a.value.titulo_notificacion,"onUpdate:modelValue":e[0]||(e[0]=o=>a.value.titulo_notificacion=o),type:"text",required:""},null,8,["modelValue"])]),_:1}),i(n,{label:"Mensaje"},{default:s(()=>[i(v,{modelValue:a.value.mensaje_notificacion,"onUpdate:modelValue":e[1]||(e[1]=o=>a.value.mensaje_notificacion=o),type:"textarea",required:""},null,8,["modelValue"])]),_:1}),i(n,{label:"Fecha de Publicación"},{default:s(()=>[i(v,{modelValue:a.value.fecha_notificacion,"onUpdate:modelValue":e[2]||(e[2]=o=>a.value.fecha_notificacion=o),type:"date",required:""},null,8,["modelValue"])]),_:1}),i(n,{label:"Estado"},{default:s(()=>[f(t("select",{"onUpdate:modelValue":e[3]||(e[3]=o=>a.value.estado_notificacion=o),class:"form-select w-full p-2 rounded-md border"},e[6]||(e[6]=[t("option",{value:"activo"},"Activo",-1),t("option",{value:"inactivo"},"Inactivo",-1)]),512),[[m,a.value.estado_notificacion]])]),_:1}),i(n,{label:"Tipo"},{default:s(()=>[f(t("select",{"onUpdate:modelValue":e[4]||(e[4]=o=>a.value.tipo_notificacion=o),class:"form-select w-full p-2 rounded-md border"},e[7]||(e[7]=[t("option",{value:"publico"},"Público",-1),t("option",{value:"privado"},"Privado",-1)]),512),[[m,a.value.tipo_notificacion]])]),_:1}),i(n,{label:"Enviar a"},{default:s(()=>[f(t("select",{"onUpdate:modelValue":e[5]||(e[5]=o=>a.value.grupo_destino=o),class:"form-select w-full p-2 rounded-md border",required:""},e[8]||(e[8]=[t("option",{value:"todos"},"Todos",-1),t("option",{value:"estudiantes"},"Estudiantes",-1),t("option",{value:"profesores"},"Profesores",-1)]),512),[[m,a.value.grupo_destino]])]),_:1}),i(I,{type:"submit",color:"info",label:"Enviar Comunicado"}),l.value?(c(),b("p",P,w(l.value),1)):V("",!0),u.value?(c(),b("p",T,w(u.value),1)):V("",!0)],32)]),_:1})]),_:1})]),_:1}))}};export{Q as default};
